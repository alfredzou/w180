<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8"/>
        <title>Resistor Calculator III</title>
        <link rel="stylesheet" href="web_styles.css"/>
        <style>
        </style>
    </head>
    <body>
        <header>
            <h1>
                Week 5: Resistor Calculator III
            </h1>
        </header>
        
        <main>
            <canvas id="resistorCanvas"></canvas>
            <p id="resistanceValue">Resistance: TBC</p>
            
            <script>
                const img = new Image();
                img.src = "/images/resistor_bands.png";
                const canvas = document.getElementById("resistorCanvas");
                const ctx = canvas.getContext("2d");
                
                img.onload = function () {
                    canvas.width = img.width;
                    canvas.height = 220;

                    ctx.drawImage(img,0,0);
                };

                function getRandomItem(arr) {
                    return arr[Math.floor(Math.random() * arr.length)];
                }
                    
                // const firstSecondBand = {
                //     black: 0
                //     , brown: 1
                //     , red: 2
                //     , orange: 3
                //     , yellow: 4
                //     , green: 5
                //     , blue: 6
                //     , violet: 7
                //     , grey: 8
                //     , white: 9
                // }
                
                // const multiplierBand = {
                //     black: 1
                //     , brown: 10
                //     , red: 100
                //     , orange: 1000
                //     , yellow: 10000
                //     , green: 100000
                //     , blue: 1000000
                //     , violet: 10000000
                //     , grey: 100000000
                //     , white: 1000000000
                //     , gold: 0.1
                //     , silver: 0.01
                // }                    

                // const toleranceBand = {
                //     brown: 1
                //     , red: 2
                //     , orange: 0.05
                //     , yellow: 0.02
                //     , green: 0.5
                //     , blue: 0.25
                //     , violet: 0.1
                //     , grey: 0.01
                //     , gold: 5
                //     , silver: 10
                // }   
                
                function getRGBFromColorName(colorName) {
                    let tempElement = document.createElement("div")
                    tempElement.style.color = colorName
                    document.body.appendChild(tempElement)

                    let computedColor = window.getComputedStyle(tempElement).color
                    document.body.removeChild(tempElement)

                    let match = computedColor.match(/\d+/g)

                    return match
                }

                const firstSecondBand = ["black", "brown", "red", "orange", "yellow", "green", "blue", "violet", "grey", "white"];
                const multiplierBand = ["black", "brown", "red", "orange", "yellow", "green", "blue", "violet", "grey", "white", "gold", "silver"];
                const toleranceBand = ["brown", "red", "orange", "yellow", "green", "blue", "violet", "grey", "gold", "silver"];

                function setBandColor(band_number) {
                    if (band_number === 1) {
                        sx = 292
                        sy = 82
                        sw = 30
                        sh = 110
                    }

                    if (band_number === 2) {
                        sx = 333
                        sy = 92
                        sw = 30
                        sh = 90
                    }
                    
                    if (band_number === 3) {
                        sx = 375
                        sy = 92
                        sw = 30
                        sh = 90
                    }

                    if (band_number === 4) {
                        sx = 456
                        sy = 82
                        sw = 30
                        sh = 110
                    }

                    color = getRGBFromColorName('grey')
                    const r = color[0]
                    const g = color[1]
                    const b = color[2]

                    const imageData = ctx.getImageData(sx, sy, sw, sh);
                    const data = imageData.data;
                    for (let i = 0; i < data.length; i += 4) {
                        if (data[i] === 255 && data[i + 1] === 255 && data[i + 2] === 255) {
                            data[i] = r
                            data[i + 1] = g
                            data[i + 2] = b
                        }
                    }
                    
                    ctx.putImageData(imageData, sx, sy)
                    
                    const output_text = document.getElementById('resistanceValue')
                    const resistance = 100
                    const unit = 'MΩ'
                    const tolerance = 0.5
                    
                    output_text.textContent = `Resistance: ${resistance} ${unit} ± ${tolerance}%` 
                }
            </script>

            <form action="/submit" method="POST">
                <p>Choose your colour bands:</p>

                <fieldset>
                    <legend>Band 1:</legend>
                    <input type="radio" id="b1-black" name="band1" value="black">
                    <label for="b1-black">black</label>
                    <input type="radio" id="b1-brown" name="band1" value="brown">
                    <label for="b1-brown">brown</label>
                    <input type="radio" id="b1-red" name="band1" value="red">
                    <label for="b1-red">red</label>
                    <input type="radio" id="b1-orange" name="band1" value="orange">
                    <label for="b1-orange">orange</label>
                    <input type="radio" id="b1-yellow" name="band1" value="yellow">
                    <label for="b1-yellow">yellow</label>
                    <input type="radio" id="b1-green" name="band1" value="green">
                    <label for="b1-green">green</label>
                    <input type="radio" id="b1-blue" name="band1" value="blue">
                    <label for="b1-blue">blue</label>
                    <input type="radio" id="b1-violet" name="band1" value="violet">
                    <label for="b1-violet">violet</label>
                    <input type="radio" id="b1-grey" name="band1" value="grey">
                    <label for="b1-grey">grey</label>
                    <input type="radio" id="b1-white" name="band1" value="white">
                    <label for="b1-white">white</label>
                </fieldset>

                <fieldset>
                    <legend>Band 2:</legend>
                    <input type="radio" id="b2-black" name="band2" value="black">
                    <label for="b2-black">black</label>
                    <input type="radio" id="b2-brown" name="band2" value="brown">
                    <label for="b2-brown">brown</label>
                    <input type="radio" id="b2-red" name="band2" value="red">
                    <label for="b2-red">red</label>
                    <input type="radio" id="b2-orange" name="band2" value="orange">
                    <label for="b2-orange">orange</label>
                    <input type="radio" id="b2-yellow" name="band2" value="yellow">
                    <label for="b2-yellow">yellow</label>
                    <input type="radio" id="b2-green" name="band2" value="green">
                    <label for="b2-green">green</label>
                    <input type="radio" id="b2-blue" name="band2" value="blue">
                    <label for="b2-blue">blue</label>
                    <input type="radio" id="b2-violet" name="band2" value="violet">
                    <label for="b2-violet">violet</label>
                    <input type="radio" id="b2-grey" name="band2" value="grey">
                    <label for="b2-grey">grey</label>
                    <input type="radio" id="b2-white" name="band2" value="white">
                    <label for="b2-white">white</label>
                </fieldset>

                <fieldset>
                    <legend>Band 3:</legend>
                    <input type="radio" id="b3-black" name="band3" value="black">
                    <label for="b3-black">black</label>
                    <input type="radio" id="b3-brown" name="band3" value="brown">
                    <label for="b3-brown">brown</label>
                    <input type="radio" id="b3-red" name="band3" value="red">
                    <label for="b3-red">red</label>
                    <input type="radio" id="b3-orange" name="band3" value="orange">
                    <label for="b3-orange">orange</label>
                    <input type="radio" id="b3-yellow" name="band3" value="yellow">
                    <label for="b3-yellow">yellow</label>
                    <input type="radio" id="b3-green" name="band3" value="green">
                    <label for="b3-green">green</label>
                    <input type="radio" id="b3-blue" name="band3" value="blue">
                    <label for="b3-blue">blue</label>
                    <input type="radio" id="b3-violet" name="band3" value="violet">
                    <label for="b3-violet">violet</label>
                    <input type="radio" id="b3-grey" name="band3" value="grey">
                    <label for="b3-grey">grey</label>
                    <input type="radio" id="b3-white" name="band3" value="white">
                    <label for="b3-white">white</label>
                    <input type="radio" id="b3-gold" name="band3" value="gold">
                    <label for="b3-gold">gold</label>
                    <input type="radio" id="b3-silver" name="band3" value="silver">
                    <label for="b3-silver">silver</label>
                </fieldset>

                <fieldset>
                    <legend>Band 4:</legend>
                    <input type="radio" id="b4-brown" name="band4" value="brown">
                    <label for="b4-brown">brown</label>
                    <input type="radio" id="b4-red" name="band4" value="red">
                    <label for="b4-red">red</label>
                    <input type="radio" id="b4-orange" name="band4" value="orange">
                    <label for="b4-orange">orange</label>
                    <input type="radio" id="b4-yellow" name="band4" value="yellow">
                    <label for="b4-yellow">yellow</label>
                    <input type="radio" id="b4-green" name="band4" value="green">
                    <label for="b4-green">green</label>
                    <input type="radio" id="b4-blue" name="band4" value="blue">
                    <label for="b4-blue">blue</label>
                    <input type="radio" id="b4-violet" name="band4" value="violet">
                    <label for="b4-violet">violet</label>
                    <input type="radio" id="b4-grey" name="band4" value="grey">
                    <label for="b4-grey">grey</label>
                    <input type="radio" id="b4-gold" name="band4" value="gold">
                    <label for="b4-gold">gold</label>
                    <input type="radio" id="b4-silver" name="band4" value="silver">
                    <label for="b4-silver">silver</label>
                </fieldset>
            </form>

            <p>
                <button onclick="setBandColor(1)">Band 1</button>
                <button onclick="setBandColor(2)">Band 2</button>
                <button onclick="setBandColor(3)">Band 3</button>
                <button onclick="setBandColor(4)">Band 4</button>
            </p>
            <br>

        </main>
        
        <footer>
            <a href="index.html">Return home</a>
        </footer>
    </body>
</html>