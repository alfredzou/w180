<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8"/>
        <title>Resistor Calculator III</title>
        <link rel="stylesheet" href="web_styles.css"/>
        <style>
        </style>
    </head>
    <body>
        <header>
            <h1>
                Week 5: Resistor Calculator III
            </h1>
        </header>
        
        <main>
            <canvas id="resistorCanvas"></canvas>
            <p id="resistanceValue">Resistance: TBC</p>
            
            <script>
                const img = new Image();
                img.src = "/images/resistor_bands.png";
                const canvas = document.getElementById("resistorCanvas");
                const ctx = canvas.getContext("2d");
                
                img.onload = function () {
                    canvas.width = img.width;
                    canvas.height = 220;

                    ctx.drawImage(img,0,0);
                };

                function getRandomItem(arr) {
                    return arr[Math.floor(Math.random() * arr.length)];
                }
                    
                // const firstSecondBand = {
                //     black: 0
                //     , brown: 1
                //     , red: 2
                //     , orange: 3
                //     , yellow: 4
                //     , green: 5
                //     , blue: 6
                //     , violet: 7
                //     , grey: 8
                //     , white: 9
                // }
                
                // const multiplierBand = {
                //     black: 1
                //     , brown: 10
                //     , red: 100
                //     , orange: 1000
                //     , yellow: 10000
                //     , green: 100000
                //     , blue: 1000000
                //     , violet: 10000000
                //     , grey: 100000000
                //     , white: 1000000000
                //     , gold: 0.1
                //     , silver: 0.01
                // }                    

                // const toleranceBand = {
                //     brown: 1
                //     , red: 2
                //     , orange: 0.05
                //     , yellow: 0.02
                //     , green: 0.5
                //     , blue: 0.25
                //     , violet: 0.1
                //     , grey: 0.01
                //     , gold: 5
                //     , silver: 10
                // }   
                
                function getRGBFromColorName(colorName) {
                    let tempElement = document.createElement("div")
                    tempElement.style.color = colorName
                    document.body.appendChild(tempElement)

                    let computedColor = window.getComputedStyle(tempElement).color
                    document.body.removeChild(tempElement)

                    let match = computedColor.match(/\d+/g)

                    return match
                }

                const firstSecondBand = ["black", "brown", "red", "orange", "yellow", "green", "blue", "violet", "grey", "white"];
                const multiplierBand = ["black", "brown", "red", "orange", "yellow", "green", "blue", "violet", "grey", "white", "gold", "silver"];
                const toleranceBand = ["brown", "red", "orange", "yellow", "green", "blue", "violet", "grey", "gold", "silver"];

                function setBandColor(band_number) {
                    if (band_number === 1) {
                        sx = 292
                        sy = 82
                        sw = 30
                        sh = 110
                    }

                    if (band_number === 2) {
                        sx = 333
                        sy = 92
                        sw = 30
                        sh = 90
                    }
                    
                    if (band_number === 3) {
                        sx = 375
                        sy = 92
                        sw = 30
                        sh = 90
                    }

                    if (band_number === 4) {
                        sx = 456
                        sy = 82
                        sw = 30
                        sh = 110
                    }

                    color = getRGBFromColorName('grey')
                    const r = color[0]
                    const g = color[1]
                    const b = color[2]

                    const imageData = ctx.getImageData(sx, sy, sw, sh);
                    const data = imageData.data;
                    for (let i = 0; i < data.length; i += 4) {
                        if (data[i] === 255 && data[i + 1] === 255 && data[i + 2] === 255) {
                            data[i] = r
                            data[i + 1] = g
                            data[i + 2] = b
                        }
                    }
                    
                    ctx.putImageData(imageData, sx, sy)
                    
                    const output_text = document.getElementById('resistanceValue')
                    const resistance = 100
                    const unit = 'MΩ'
                    const tolerance = 0.5
                    
                    output_text.textContent = `Resistance: ${resistance} ${unit} ± ${tolerance}%` 
                }
            </script>

            <p>
                <button onclick="setBandColor(1)">Band 1</button>
                <button onclick="setBandColor(2)">Band 2</button>
                <button onclick="setBandColor(3)">Band 3</button>
                <button onclick="setBandColor(4)">Band 4</button>
            </p>
            <br>

        </main>
        
        <footer>
            <a href="index.html">Return home</a>
        </footer>
    </body>
</html>